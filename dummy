from sentence_transformers import SentenceTransformer, util

model = SentenceTransformer('all-MiniLM-L6-v2')

# Encode the sentences
embeddings1 = model.encode(df['Response1'].tolist(), convert_to_tensor=True)
embeddings2 = model.encode(df['Response2'].tolist(), convert_to_tensor=True)

# Compute cosine similarity
cosine_scores = util.pytorch_cos_sim(embeddings1, embeddings2)

# Add to DataFrame
df['Semantic_Similarity'] = [cosine_scores[i][i].item() for i in range(len(df))]
print(df)
