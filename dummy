import os

def kebab_to_title(kebab_str):
    """
    Convert a kebab-case string to Title Case.
    Example: 'advance-access' -> 'Advance Access'
    """
    return kebab_str.replace('-', ' ').title()

def rename_files_in_folders(root_folder):
    """
    Traverse through all subfolders and rename files by prepending the folder name in Title Case.
    Format: FolderName_filename.pdf
    """
    for folder_name, subfolders, files in os.walk(root_folder):
        # Extract the folder name and convert from kebab-case to Title Case
        kebab_case_folder = os.path.basename(folder_name)
        title_case_folder = kebab_to_title(kebab_case_folder)
        
        # Loop through each file in the folder
        for file_name in files:
            # Get the file extension
            file_ext = os.path.splitext(file_name)[1]
            
            # Skip non-PDF files (if needed, modify this for other file types)
            if not file_name.endswith('.pdf'):
                continue
            
            # Generate the new file name: FolderName_filename
            new_file_name = f"{title_case_folder}_{file_name}"
            
            # Get full paths for renaming
            old_file_path = os.path.join(folder_name, file_name)
            new_file_path = os.path.join(folder_name, new_file_name)
            
            # Rename the file
            os.rename(old_file_path, new_file_path)
            print(f"Renamed: {old_file_path} -> {new_file_path}")

# Main execution
if __name__ == "__main__":
    root_directory = "/path/to/your/folder"  # Replace with the path to your root folder
    rename_files_in_folders(root_directory)
